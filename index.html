<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>OneDrive Picker Test</title>
  <script src="https://js.live.net/v7.2/OneDrive.js"></script>
</head>
<body>

  <h1>Test OneDrive Picker</h1>

  <button onclick="openPicker()">Otevřít OneDrive Picker</button>

  <script>
function openPicker() {
  var odOptions = {
    clientId: "7a4d1385-9b7c-47d3-8669-1abf187d7483", // To, které máte v Azure
    action: "query",
    multiSelect: false,
    advanced: {
      // 1. TADY MUSÍ BÝT PŘESNÁ URL Z AZURE (sekce SPA)
      redirectUri: window.location.origin + window.location.pathname, 

      // 2. Nutné pro firemní účty (SharePoint/OneDrive for Business)
      endpointHint: "<a href="https://akcenta.sharepoint.com/" itemtype="http://schema.skype.com/HyperLink/Files" rel="noreferrer noopener" title="https://akcenta.sharepoint.com/" target="_blank" itemid="3f3de66a-1a56-46f1-9c4f-362450ba642e">https://akcenta.sharepoint.com/</a>", 

      // 3. Vynucení novějšího protokolu
      queryParameters: "select=id,name,size,webUrl",
      isPopup: true
    },
    success: function(files) {
      console.log(files);
      alert("Vybral jsi: " + files.value[0].name);
    },
    cancel: function() {
      console.log("Picker zavřen");
    },
    error: function(e) {
      console.error("Detailní chyba:", e);
      // Pokud e obsahuje "badResponse", prověřte síťovou kartu (F12 -> Network)
      alert("Chyba: " + (e.errorCode || "neznámá") + " - " + (e.message || "badResponse"));
    }
  };

  OneDrive.open(odOptions);
}
  </script>

</body>
</html>



