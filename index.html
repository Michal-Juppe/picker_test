<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>OneDrive Picker Test</title>
  <script src="https://js.live.net/v7.2/OneDrive.js"></script>
</head>
<body>

  <h1>Test OneDrive Picker</h1>

  <button onclick="openPicker()">Otevřít OneDrive Picker</button>

  <script>
function openPicker() {
  var odOptions = {
    clientId: "7a4d1385-9b7c-47d3-8669-1abf187d7483",
    // Změna na "download", abyste získali přímou URL k souboru (downloadUrl)
    action: "download", 
    multiSelect: false,
    advanced: {
      redirectUri: window.location.origin + window.location.pathname,
      // Nasměrování na osobní OneDrive uživatele
      endpointHint: "https://akcenta-my.sharepoint.com",
      isPopup: true
    },
    success: function(files) {
      /* V objektu 'files' teď máte vše potřebné. 
         files.value[0]["@microsoft.graph.downloadUrl"] je přímý odkaz, 
         ze kterého váš server může soubor stáhnout a uložit k sobě.
      */
      console.log("Data souboru:", files.value[0]);

      const fileName = files.value[0].name;
      const downloadUrl = files.value[0]["@microsoft.graph.downloadUrl"];

      // Zde zavoláte svou funkci, která pošle URL na váš server k nahrání
      alert("Soubor '" + fileName + "' byl úspěšně vybrán a je připraven k nahrání.");

      // Příklad: nahraniSouboruNaServer(downloadUrl, fileName);
    },
    cancel: function() {
      console.log("Uživatel zrušil výběr.");
    },
    error: function(e) {
      console.error("Chyba:", e);
      alert("Chyba při výběru: " + (e.errorCode || "neznámá chyba"));
    }
  };

  OneDrive.open(odOptions);
}
  </script>

</body>
</html>



